<!doctype html>
<html class="not-ready lg:text-base overflow-y-scroll scroll-pt-14" lang="en">

<head prefix="og: https://ogp.me/ns# article: https://ogp.me/ns/article#">
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="generator" content="Zola" />
  <title>DVID - Damn Vulnerable IoT Device | Swissky's Lab</title>
  <meta property="og:site_name" content="Swissky&apos;s Lab" />
  <meta property="og:title" content="DVID - Damn Vulnerable IoT Device" />
  <meta name="description" content="Who ever wanted to learn about Hardware Hacking ? I found this small opensource IoT hacking learning board while I was in a security event. It is designed by @vulcainreo and cost around 45€, more than…" />
  <meta property="og:description" content="Who ever wanted to learn about Hardware Hacking ? I found this small opensource IoT hacking learning board while I was in a security event. It is designed by @vulcainreo and cost around 45€, more than 300 units were shipped around the world.Let&apos;s dig into this awesome project and clone the git : htt…" />
  <meta property="og:url" content="https://swisskyrepo.github.io/blog/dvid/" />
  <link rel="canonical" href="https://swisskyrepo.github.io/blog/dvid/" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2019-12-26T00:00:00+00:00" />
  <meta property="og:image" content="https://swisskyrepo.github.io/images/DVID/bleadvertising.jpg" />
  <meta property="og:image:alt" content="DVID - Damn Vulnerable IoT Device" />
  <meta property="og:image:width" content="3000" />
  <meta property="og:image:height" content="4000" />
  <meta property="og:image:type" content="image/jpeg" />
  <link rel="alternate" type="application/atom+xml" href="https://swisskyrepo.github.io/atom.xml" title="Swissky&apos;s Lab | Atom" />
  <link rel="alternate" type="application/rss+xml" href="https://swisskyrepo.github.io/rss.xml" title="Swissky&apos;s Lab | RSS" />
  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed" />
  <!-- Begin Head inject -->
  
  <!-- End Head inject -->
  <link rel="stylesheet" href="https://swisskyrepo.github.io/main.min.css?h=fc65ba308cf36d3ba82c" />
  <style>
  :root{--bg: #f4f4f5; --header: #e4e4e7; color-scheme: light;}
  :root.dark{--bg: #18181b; --header: #27272a; color-scheme: dark;}
  </style>
  <meta name="theme-color" data-light="#e4e4e7" data-dark="#27272a" content="#e4e4e7" />
  <link rel="icon" type="image/x-icon" sizes="16x16" href="https://swisskyrepo.github.io/favicon.ico" />
  <link rel="apple-touch-icon" type="image/png" href="https://swisskyrepo.github.io/apple-touch-icon.png?h=58bee300054c5308feb3" />
  <link rel="icon" type="image/png" href="https://swisskyrepo.github.io/android-icon.png?h=8d80ec95446bd2c36826" />
  <script src="https://swisskyrepo.github.io/js/linkita.min.js?h=1dd3ed42fc674277bc34"></script>
  <script src="https://swisskyrepo.github.io/js/linkita-search.min.js?h=698547b4b081d012c661"></script>
  <!-- Begin Head End inject -->
  <!-- Umami analytics -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="3da49f88-7825-49a6-b9cf-de0c7610e7dc"></script>

<!-- Custom CSS -->
<link rel="stylesheet" href="https://swisskyrepo.github.io/files/custom.css">

<!-- HEAD END -->
  <!-- End Head End inject -->
</head>

<body class="text-black duration-100 ease-out bg-[var(--bg)] dark:text-white">
  <!-- Header -->
<header class="bg-[var(--header)] fixed top-0 z-40 mx-auto min-h-[3.25rem] w-full header-icons">
  <div class="mx-auto w-full max-w-4xl p-2.5 lg:flex lg:justify-between">
    <div class="flex justify-between">
      <div class="flex items-center min-h-8">
        <a title="Go to home page" accesskey="!"
          href="https://swisskyrepo.github.io/" class="text-2xl font-semibold">Swissky&#x27;s Lab</a>
        <button type="button" title="Switch color scheme" accesskey="$"
          onclick="window.linkita.toggleDarkMode();" ondblclick="window.linkita.resetDarkMode();"
          class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] bg-center bg-no-repeat bg-cover dark:invert [background-image:var(--icon-theme-dark)] dark:[background-image:var(--icon-theme-light)]"
        ></button>
        <button type="button" title="Search" accesskey="/"
          onclick="window.linkita.toggleSearch();"
          class="btn-search ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] bg-center bg-no-repeat bg-cover [background-image:var(--icon-search)] dark:invert"
        ></button>
        <script>window.linkita.initSearchButton({ scripts: ["https://swisskyrepo.github.io/elasticlunr.min.js", "https://swisskyrepo.github.io/search_index.en.js"] });</script>
      </div>
      <div title="Menu" role="button" accesskey="+" tabindex="0"
        class="btn-menu relative z-50 flex h-8 w-8 shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
        onclick="window.linkita.toggleHeaderMenu();"
        onkeydown="(event.keyCode == 13 || event.keyCode == 32) ? event.preventDefault() || window.linkita.toggleHeaderMenu() : true;"
      ></div>
    </div>
    <nav class="flex w-full items-center lg:w-auto">
      <menu
        class="nav-wrapper flex w-full flex-col py-2 lg:w-auto lg:flex-row lg:self-center lg:py-0">
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/projects"
          >Projects</a>
        </li>
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/posts"
          >Posts</a>
        </li>
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://swisskyrepo.github.io/about"
          >About</a>
        </li>
      </menu>
      <!-- Begin Header Nav inject -->
      
      <!-- End Header Nav inject -->
    </nav>
  </div>
</header>

  <!-- Begin Body Start inject -->
  
  <!-- End Body Start inject -->
  <main class="prose prose-neutral relative mx-auto min-h-[calc(100%-4rem)]
    max-w-3xl break-words px-4 pb-12 pt-28 lg:pt-32 dark:prose-invert prose-pre:rounded-lg prose-img:rounded-lg">
      <!-- Search -->
<div id="linkita-search-wrapper" class="hidden">
  <ul id="linkita-search-results"></ul>
</div>

    
<article>
  <!-- Begin Page Start inject -->
  
  <!-- End Page Start inject -->

  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">DVID - Damn Vulnerable IoT Device</h1>
    <!-- Page Info -->
<div class="text-sm antialiased opacity-80"><time
      datetime="2019-12-26T00:00:00+00:00">2019-12-26</time><span
        class="mx-1">&middot;</span><time
    datetime="PT0H4M0S">4&nbsp;min</time>
</div>

  </header>
  <figure class="mb-12 mt-0">
    <img
      class="h-auto w-full rounded-lg"
      src="https://swisskyrepo.github.io/images/DVID/bleadvertising.jpg"
      alt="DVID - Damn Vulnerable IoT Device"
      width="3000"
      height="4000"
    />
  </figure>
  <!-- TOC -->
<div class="block-bg mb-12 rounded-lg p-2 text-lg">
  <details>
    <summary class="select-none py-0.5 lg:py-1 pl-4" accesskey="=">
      <span class="cursor-pointer">Table of Contents</span>
    </summary>
    <div class="px-2">
      <ul>
        <li>
          <a class="no-underline hover:underline" href="https://swisskyrepo.github.io/blog/dvid/#hardware-findthedatasheet">Hardware - findTheDatasheet</a>
        </li>
        <li>
          <a class="no-underline hover:underline" href="https://swisskyrepo.github.io/blog/dvid/#firmware-default-password">Firmware - Default Password</a>
        </li>
        <li>
          <a class="no-underline hover:underline" href="https://swisskyrepo.github.io/blog/dvid/#firmware-hardcoded-password">Firmware - Hardcoded Password</a>
        </li>
        <li>
          <a class="no-underline hover:underline" href="https://swisskyrepo.github.io/blog/dvid/#bluetooth-advertising">Bluetooth - Advertising</a>
        </li>
      </ul>
    </div>
  </details>
</div>

  <!-- Content -->
  <section><p>Who ever wanted to learn about Hardware Hacking ? I found this small opensource <strong>IoT hacking</strong> learning board while I was in a security event. It is designed by <a href="https://twitter.com/vulcainreo/">@vulcainreo</a> and cost around 45€, more than 300 units were shipped around the world.</p>
<p>Let's dig into this awesome project and clone the git : <code>https://github.com/Vulcainreo/DVID.git</code> !</p>
<p><img src="https://raw.githubusercontent.com/Vulcainreo/DVID/master/kit-contents.jpg" alt="https://raw.githubusercontent.com/Vulcainreo/DVID/master/kit-contents.jpg" /></p>
<span id="continue-reading"></span>
<h3 id="hardware-findthedatasheet">Hardware - findTheDatasheet</h3>
<blockquote>
<p>A password is displayed on the pin PD1</p>
</blockquote>
<p>First we need to push the correct firmware to start playing with the device, the LED will blink.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>$ sudo avrdude -c usbasp -p m328p -U flash:w:findTheDatasheet.ino.arduino_standard.hex 
</span><span>
</span><span>avrdude: warning: cannot set sck period. please check </span><span style="color:#b48ead;">for </span><span>usbasp firmware update.
</span><span>avrdude: </span><span style="color:#bf616a;">AVR </span><span>device initialized and ready to accept instructions
</span><span>
</span><span>Reading | </span><span style="color:#65737e;">################################################## | 100% 0.00s
</span><span>
</span><span>avrdude: Device signature = </span><span style="color:#d08770;">0x1e950f </span><span>(probably m328p)
</span><span>avrdude: </span><span style="color:#bf616a;">NOTE</span><span>: &quot;</span><span style="color:#a3be8c;">flash</span><span>&quot; memory has been specified, an erase cycle will be performed
</span><span>         To disable this feature, specify the -D option.
</span><span>avrdude: erasing chip
</span><span>avrdude: warning: cannot set sck period. please check </span><span style="color:#b48ead;">for </span><span>usbasp firmware update.
</span><span>avrdude: reading </span><span style="color:#96b5b4;">input </span><span>file &quot;</span><span style="color:#a3be8c;">findTheDatasheet.ino.arduino_standard.hex</span><span>&quot;
</span><span>avrdude: </span><span style="color:#96b5b4;">input </span><span>file findTheDatasheet.ino.arduino_standard.hex auto detected </span><span style="background-color:#bf616a;color:#2b303b;">as</span><span> Intel Hex
</span><span>avrdude: writing </span><span style="color:#bf616a;">flash </span><span>(</span><span style="color:#d08770;">14346 </span><span>bytes):
</span><span>
</span><span>Writing | </span><span style="color:#65737e;">########################                           | 48% 7.14s
</span></code></pre>
<p>We are asked to connect RX to the PD1 pin to get the password, we need to check the Datasheet to know where is the PD1 pin.</p>
<p>![RXfind]({{ site.baseurl }}/images/DVID/rx_finddatasheet.jpg "RXfind"){: .center-image }</p>
<p>The board is using an ATmega328, let's check the pinout from Wikipedia : https://en.wikipedia.org/wiki/ATmega328, we see PD1 is linked to UART TXD pin.</p>
<p><img src="http://www.datasheetcafe.com/wp-content/uploads/2015/10/ATmega328P-Pinout-Datasheet.gif" alt="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f9/ATmega328P_28-PDIP.svg/465px-ATmega328P_28-PDIP.svg.png" /></p>
<p>Using the Gerber file <strong>Gerber_BottomLayer.GBL</strong> provided in the github we can also see the PD1 pin is linked to Soft Flash TX, I used http://www.gerber-viewer.com to display the file.</p>
<p>![GerberViewer]({{ site.baseurl }}/images/DVID/GerberViewerPD1bis.png "GerberViewer"){: .center-image }</p>
<p>A simple wiring to the UART port is enough to connect the DVID to my Kali Linux VM, we can then access i
t through <strong>/dev/ttyUSB0</strong>. We can check our VM logs using <strong>dmesg</strong> command.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> sudo dmesg</span><span style="color:#bf616a;"> -w 
</span><span style="color:#bf616a;">[10691.448743]</span><span> usb 3-3.1: new full-speed USB device number 8 using xhci_hcd
</span><span style="color:#bf616a;">[10691.770954]</span><span> usb 3-3.1: New USB device found, idVendor=10c4, idProduct=ea60, bcdDevice= 1.00
</span><span style="color:#bf616a;">[10691.770956]</span><span> usb 3-3.1: New USB device strings: Mfr=1, Product=2, SerialNumber=3
</span><span style="color:#bf616a;">[10691.770957]</span><span> usb 3-3.1: Product: CP2102 USB to UART Bridge Controller
</span><span style="color:#bf616a;">[10691.770959]</span><span> usb 3-3.1: Manufacturer: Silicon Labs
</span><span style="color:#bf616a;">[10691.770960]</span><span> usb 3-3.1: SerialNumber: 0001
</span><span style="color:#bf616a;">[10691.827000]</span><span> usbcore: registered new interface driver usbserial_generic
</span><span style="color:#bf616a;">[10691.827757]</span><span> usbserial: USB Serial support registered for generic
</span><span style="color:#bf616a;">[10691.835531]</span><span> usbcore: registered new interface driver cp210x
</span><span style="color:#bf616a;">[10691.835539]</span><span> usbserial: USB Serial support registered for cp210x
</span><span style="color:#bf616a;">[10691.835560]</span><span> cp210x 3-3.1:1.0: cp210x converter detected
</span><span style="color:#bf616a;">[10691.839533]</span><span> usb 3-3.1: cp210x converter now attached to ttyUSB0
</span></code></pre>
<p>From there we only need to read the output with Python or with <code>minicom -b 9600 -o -D /dev/ttyUSB0</code> (use Ctrl A + X to exit).</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>$ python2
</span><span>Python </span><span style="color:#d08770;">2.7.17 </span><span>(default, Oct </span><span style="color:#d08770;">19 2019</span><span>, </span><span style="color:#d08770;">23</span><span>:</span><span style="color:#d08770;">36</span><span>:</span><span style="color:#d08770;">22</span><span>) 
</span><span>[</span><span style="color:#bf616a;">GCC </span><span style="color:#d08770;">9.2.1 20191008</span><span>] on linux2
</span><span>Type &quot;</span><span style="color:#a3be8c;">help</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">copyright</span><span>&quot;, &quot;</span><span style="color:#a3be8c;">credits</span><span>&quot; or &quot;</span><span style="color:#a3be8c;">license</span><span>&quot; </span><span style="color:#b48ead;">for </span><span>more information.
</span><span>&gt;&gt;&gt; </span><span style="color:#b48ead;">import </span><span>serial 
</span><span>&gt;&gt;&gt; port = &#39;</span><span style="color:#a3be8c;">/dev/ttyUSB0</span><span>&#39;
</span><span>&gt;&gt;&gt; baud = </span><span style="color:#d08770;">9600
</span><span>&gt;&gt;&gt; ser = serial.</span><span style="color:#bf616a;">Serial</span><span>(port,baud)
</span><span>&gt;&gt;&gt; read = ser.</span><span style="color:#bf616a;">readline</span><span>().</span><span style="color:#bf616a;">decode</span><span>(&#39;</span><span style="color:#a3be8c;">utf-8</span><span>&#39;)
</span><span>&gt;&gt;&gt; </span><span style="color:#96b5b4;">print</span><span>(read)
</span><span>D***[</span><span style="color:#d08770;">...</span><span>]******
</span></code></pre>
<p>![Minicom]({{ site.baseurl }}/images/DVID/minicom_finddatasheet.png "Minicom"){: .center-image }</p>
<h3 id="firmware-default-password">Firmware - Default Password</h3>
<blockquote>
<p>A confidential message is stored on the firmware but protected by a default password.</p>
</blockquote>
<p>Once again we push the firmware : <code>sudo avrdude -c usbasp -p m328p -U flash:w:defaultPassword.ino.arduino_standard.hex</code>.</p>
<p>Since the challenge is to find a default password, we will connect to the debug interface (UART) of the DVID and try to interact with it. First we need to wire it correctly, remember to pair RX with TX and TX with RX, and do NOT plug the USB if you wire the 5v pin ;)</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">VCC </span><span>&lt;---&gt; VCC
</span><span style="color:#bf616a;">RX  </span><span>&lt;---&gt; TX
</span><span style="color:#bf616a;">TX  </span><span>&lt;---&gt; RX
</span><span style="color:#bf616a;">GND </span><span>&lt;---&gt; GND
</span></code></pre>
<p>Using the code from the last challenge we can write a simple script to interact with the device /dev/ttyUSB0. We will iterate over the john wordlist to bruteforce the service until it responds with "ok" instead of "ko".</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>serial, time
</span><span>port = &quot;</span><span style="color:#a3be8c;">/dev/ttyUSB0</span><span>&quot;
</span><span>baud = </span><span style="color:#d08770;">9600
</span><span>s = serial.</span><span style="color:#bf616a;">Serial</span><span>(port)
</span><span>s.baudrate = baud
</span><span>
</span><span style="color:#b48ead;">with </span><span style="color:#96b5b4;">open</span><span>(&#39;</span><span style="color:#a3be8c;">/usr/share/john/password.lst</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">r</span><span>&#39;) </span><span style="color:#b48ead;">as </span><span>f:
</span><span>    lines = f.</span><span style="color:#bf616a;">readlines</span><span>()
</span><span>
</span><span>    </span><span style="color:#b48ead;">for </span><span>pwd </span><span style="color:#b48ead;">in </span><span>lines:
</span><span>        </span><span style="color:#b48ead;">if </span><span>not &quot;</span><span style="color:#a3be8c;">#</span><span>&quot; in pwd:
</span><span>            res = s.</span><span style="color:#bf616a;">write</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>())
</span><span>            </span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Pwd: </span><span style="color:#d08770;">{}</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>()))
</span><span>            </span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Sent </span><span style="color:#d08770;">{}</span><span style="color:#a3be8c;"> bytes</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(res))
</span><span>            </span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Result: </span><span style="color:#d08770;">{}</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(s.</span><span style="color:#bf616a;">readline</span><span>()))
</span><span>            time.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">3</span><span>)
</span></code></pre>
<p>And we got it ! Obviously the password is hidden, real one is available <a href="https://www.youtube.com/watch?v=SCaAetNzXIc">here</a> :D</p>
<p>![DefaultPasswd]({{ site.baseurl }}/images/DVID/defaultpasswd.jpg "DefaultPasswd"){: .center-image }</p>
<h3 id="firmware-hardcoded-password">Firmware - Hardcoded Password</h3>
<blockquote>
<p>A confidential message is stored on the firmware but protected by a password.</p>
</blockquote>
<p>We push the firmware with  <code>sudo avrdude -c usbasp -p m328p -U flash:w:hardcodedPassword.ino.arduino_standard.hex</code>.</p>
<p>Now we will dump the previously sent firmware, we could just analyse the <strong>hardcodedPassword.ino.arduino_standard.hex</strong> file but it is not realistic.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>$ sudo avrdude -c usbasp -p m328p -F -U flash:r:dump.hex:i
</span><span>avrdude: warning: cannot set sck period. please check </span><span style="color:#b48ead;">for </span><span>usbasp firmware update.
</span><span>avrdude: </span><span style="color:#bf616a;">AVR </span><span>device initialized and ready to accept instructions
</span><span>Reading | </span><span style="color:#65737e;">################################################## | 100% 0.00s
</span><span>
</span><span>avrdude: Device signature = </span><span style="color:#d08770;">0x1e950f </span><span>(probably m328p)
</span><span>avrdude: reading flash memory:
</span><span>Reading | </span><span style="color:#65737e;">################################################## | 100% 17.15s
</span><span>
</span><span>avrdude: writing output file &quot;</span><span style="color:#a3be8c;">dump.hex</span><span>&quot;
</span><span>avrdude: safemode: Fuses </span><span style="color:#bf616a;">OK </span><span>(E:</span><span style="color:#bf616a;">FF</span><span>, H:D9, L:E2)
</span><span>avrdude done.  Thank you.
</span></code></pre>
<p>Now we have a file <strong>dump.hex</strong> containing the current firmware, let's convert it to binary with <code>avr-objcopy -I ihex -O elf32-avr dump.hex dump.elf</code>.
we could also dump the firmware as raw binary with <code>sudo avrdude -c usbasp -p m328p -F -U flash:r:dump.raw:r</code>.</p>
<p>From these dumps we can make a wordlist of every strings in there, then we will try to bruteforce the service by sending everyone of them.</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> strings dump.elf</span><span style="color:#bf616a;"> -n</span><span> 10 | </span><span style="color:#bf616a;">tee</span><span> passwords.lst
</span><span>&gt;[O[&gt;&gt;kOk&gt;
</span><span style="color:#bf616a;">rIIIF!AIM3
</span><span>&#39;</span><span style="color:#a3be8c;">EEE9&lt;JII1A!
</span><span style="color:#a3be8c;">(DD88DDD(8DD(
</span><span style="color:#a3be8c;">:@@ z8TTUY!UUyA&quot;TTxB!UTx@ TUy@
</span><span style="color:#a3be8c;">9UUUY9TTTY9UTTX
</span><span style="color:#a3be8c;">I2III2:DDD:2JHH0:AA!z:B@ x
</span><span style="color:#a3be8c;">}=BBB==@@@=&lt;$
</span><span style="color:#a3be8c;">D}A0HHJ28@@&quot;z
</span><span style="color:#a3be8c;">1}&amp;))/(&amp;)))&amp;0HM@ 8
</span><span style="color:#a3be8c;">rL0JMM00HxH0
</span><span style="color:#a3be8c;">~*****DD_DD@QJD@@DJQ@
</span><span style="color:#a3be8c;">d</span><span>&#39;</span><span style="color:#bf616a;">u</span><span>&#39;</span><span style="color:#a3be8c;">F</span><span>&#39;</span><span style="color:#bf616a;">W</span><span>&#39;</span><span style="color:#a3be8c;">d</span><span>&#39;</span><span style="color:#bf616a;">u</span><span>&#39;
</span><span style="color:#a3be8c;">sup3rp4ssw0rd
</span><span style="color:#a3be8c;">T5uzzrhz4tf23lsccbes1111
</span><span style="color:#a3be8c;">T03 Hard.Pass.   
</span><span style="color:#a3be8c;">I have confidential message. Pass ?
</span><span style="color:#a3be8c;">Wrong password
</span><span style="color:#a3be8c;">Well done! Message : 
</span></code></pre>
<p>We can reuse the last challenge script, this time we have to remove the <code>s.readline()</code> line since we are blindly attacking the service. Nothing will be outputted on the serial port in case of a good password, we need to pay attention to the screen, fortunately the password is in our small list of 15 passwords.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>serial, time
</span><span>port = &quot;</span><span style="color:#a3be8c;">/dev/ttyUSB0</span><span>&quot;
</span><span>baud = </span><span style="color:#d08770;">9600
</span><span>s = serial.</span><span style="color:#bf616a;">Serial</span><span>(port)
</span><span>s.baudrate = baud
</span><span>
</span><span style="color:#b48ead;">with </span><span style="color:#96b5b4;">open</span><span>(&#39;</span><span style="color:#a3be8c;">passwords.lst</span><span>&#39;, &#39;</span><span style="color:#a3be8c;">r</span><span>&#39;) </span><span style="color:#b48ead;">as </span><span>f:
</span><span>    lines = f.</span><span style="color:#bf616a;">readlines</span><span>()
</span><span>
</span><span>    </span><span style="color:#b48ead;">for </span><span>pwd </span><span style="color:#b48ead;">in </span><span>lines:
</span><span>        a = s.</span><span style="color:#bf616a;">write</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>())
</span><span>        </span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Pwd: </span><span style="color:#d08770;">{}</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>()))
</span><span>        </span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Sent </span><span style="color:#d08770;">{}</span><span style="color:#a3be8c;"> bytes</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(a))
</span><span>        time.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">10</span><span>)
</span></code></pre>
<p>The <code>time.sleep(10)</code> is very important, we don't want to flood the board with too many passwords !</p>
<p>![HardPasswd]({{ site.baseurl }}/images/DVID/hardpasswd.jpg "HardPasswd"){: .center-image }</p>
<h3 id="bluetooth-advertising">Bluetooth - Advertising</h3>
<blockquote>
<p>A confidential message is stored on the firmware but protected by a password</p>
</blockquote>
<ul>
<li>The goal is to provide a screenshot of the confidential message</li>
<li>Tips: Hey ! Advertise me to know my name</li>
</ul>
<p>I had to setup my virtual machine correctly to use the Bluetooth dongle provided with the DVID, the following commands were enough to get it running. However I later discovered the BLE was not working as it should be...</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">$</span><span> systemctl enable bluetooth
</span><span style="color:#bf616a;">$</span><span> sudo systemctl restart bluetooth
</span><span>
</span><span style="color:#bf616a;">$</span><span> bluetoothctl
</span><span style="color:#bf616a;">[bluetooth]#</span><span> select 18:1D:EA:9E:XX:XX 
</span><span style="color:#bf616a;">Controller</span><span> 18:1D:EA:9E:XX:XX vmkali </span><span style="color:#b48ead;">[</span><span>default</span><span style="color:#b48ead;">]
</span><span style="color:#bf616a;">[bluetooth]#</span><span> power on
</span><span style="color:#bf616a;">Changing</span><span> power on succeeded
</span><span style="color:#bf616a;">[bluetooth]#</span><span> scan on
</span><span style="color:#bf616a;">Discovery</span><span> started
</span><span style="color:#bf616a;">[CHG]</span><span> Controller 18:1D:EA:9E:XX:XX Discovering: yes
</span><span style="color:#bf616a;">[CHG]</span><span> Device 38:18:4C:YY:YY:YY LegacyPairing: no
</span><span style="color:#bf616a;">[CHG]</span><span> Device 38:18:4C:YY:YY:YY RSSI: 127
</span><span style="color:#bf616a;">[CHG]</span><span> Device 38:18:4C:YY:YY:YY Name: WH-1000XM3
</span><span style="color:#bf616a;">Here</span><span> the DVID should have appeared ...
</span></code></pre>
<p>NOTE: from there I switched to my Phone and the application <a href="https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp&amp;hl=en_US">NRF Connect</a>. In order to get the flag we have to send the bluetooth name through the serial port.</p>
<p>![BLEName]({{ site.baseurl }}/images/DVID/blename.jpg "BLEName"){: .center-image }</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>serial, time
</span><span>port = &quot;</span><span style="color:#a3be8c;">/dev/ttyUSB0</span><span>&quot;
</span><span>baud = </span><span style="color:#d08770;">9600
</span><span>s = serial.</span><span style="color:#bf616a;">Serial</span><span>(port)
</span><span>s.baudrate = baud
</span><span>pwd = &quot;</span><span style="color:#a3be8c;">dvid-redacted</span><span>&quot;
</span><span>res = s.</span><span style="color:#bf616a;">write</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>())
</span><span style="color:#96b5b4;">print</span><span>(&quot;</span><span style="color:#a3be8c;">Pwd: </span><span style="color:#d08770;">{}</span><span>&quot;.</span><span style="color:#bf616a;">format</span><span>(pwd.</span><span style="color:#bf616a;">strip</span><span>()))
</span><span>time.</span><span style="color:#bf616a;">sleep</span><span>(</span><span style="color:#d08770;">3</span><span>)
</span></code></pre>
<p>![BLEAdvert]({{ site.baseurl }}/images/DVID/bleadvertising.jpg "BLEAdvert"){: .center-image }</p>
</section>
  <hr />
  <!-- Post Taxonomies -->

  <!-- Post Nav -->
<nav class="block-bg mt-12 flex flex-wrap rounded-lg text-lg">
  <a
    class="block-hover-mask flex min-w-[50%] grow items-center rounded-l-md p-6 pr-3 font-semibold no-underline"
    href="https://swisskyrepo.github.io/blog/fcsc/" accesskey=","
    ><span class="mr-1.5">&#8249;</span><span>FCSC - CTF Writeup</span></a>
  <a
    class="block-hover-mask ml-auto flex min-w-[50%] grow items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline"
    href="https://swisskyrepo.github.io/blog/ph0wn-ctf/" accesskey="."
    ><span>Ph0wn CTF 2019 - Smart Devices CTF</span><span class="ml-1.5">&#8250;</span></a>
</nav>

  <!-- Begin Page End inject -->
  <!-- Share page -->
<br>

<div class="robots-nocontent social-share-buttons">
  <b>Share this content</b>
  <br>
  <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
    <a class="a2a_button_x"></a>
    <a class="a2a_button_linkedin"></a>
    <a class="a2a_button_telegram"></a>
    <a class="a2a_button_mastodon"></a>
    <a class="a2a_button_email"></a>
    <a class="a2a_button_microsoft_teams"></a>
    <a class="a2a_button_threads"></a>
    <a class="a2a_button_bluesky"></a>
    <a class="a2a_button_whatsapp"></a>
  </div>
  <br>
  <script async src="https://static.addtoany.com/menu/page.js"></script>
</div>
  <!-- End Page End inject -->
</article>

  </main>
  <!-- Footer -->
<footer class="mx-auto flex lg:mt-5 max-w-3xl flex-wrap items-center px-4 py-3 text-sm opacity-60">
  <div class="mr-auto basis-full lg:basis-1/2">
  <a href="https://creativecommons.org/licenses/by-sa/4.0/deed">© <time datetime="2017">2017</time> - <time datetime="2025">2025</time> Swissky</a>
  </div>
  <div class="flex basis-full lg:basis-1/2 lg:justify-end">
    <span class="mr-6 lg:ml-6">
      <a class="link" href="https://www.getzola.org/" target="_blank">Powered by Zola</a>
    </span>
    <a class="link" href="https://www.getzola.org/themes/linkita/" target="_blank">&#9998; Linkita</a>
  </div>
  <!-- Begin Footer inject -->
  
  <!-- End Footer inject -->
</footer>

  
  <!-- Begin Body End inject -->
  
  <!-- End Body End inject -->
</body>

</html>
